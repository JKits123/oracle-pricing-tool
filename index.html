<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oracle Smart Pricing Tool - Current Development Limited</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header class="wizard-header">
            <div class="logo-section">
                <div class="company-logo-placeholder">CDL</div>
                <div class="tool-title">
                    <h1>Oracle Smart Pricing Tool</h1>
                    <p>Intelligent Air Conditioning System Pricing</p>
                </div>
            </div>
        </header>

        <main class="wizard-main">
            <div class="wizard-container">
                <div class="wizard-header-section">
                    <h2>Project Configuration Wizard</h2>
                    <p>Answer a few questions to get an intelligent, pre-configured quote</p>
                </div>

                <form id="projectWizard" class="wizard-form">
                    
                    <!-- Step 1: Customer Information -->
                    <div class="wizard-step active" id="step1">
                        <div class="step-header">
                            <span class="step-number">1</span>
                            <h3>Customer Information</h3>
                        </div>
                        
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="customerName">Customer Name *</label>
                                <input type="text" id="customerName" name="customerName" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="projectName">Project Name</label>
                                <input type="text" id="projectName" name="projectName" placeholder="e.g., Office Air Con Installation">
                            </div>
                            
                            <div class="form-group full-width">
                                <label for="customerAddress">Installation Address *</label>
                                <textarea id="customerAddress" name="customerAddress" rows="3" required></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="contactPhone">Contact Phone</label>
                                <input type="tel" id="contactPhone" name="contactPhone">
                            </div>
                            
                            <div class="form-group">
                                <label for="contactEmail">Contact Email</label>
                                <input type="email" id="contactEmail" name="contactEmail">
                            </div>
                        </div>
                    </div>

                    <!-- Step 2: Project Type & Requirements -->
                    <div class="wizard-step" id="step2">
                        <div class="step-header">
                            <span class="step-number">2</span>
                            <h3>Project Requirements</h3>
                        </div>
                        
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="projectType">Project Type *</label>
                                <select id="projectType" name="projectType" required onchange="updatePreview()">
                                    <option value="">Select project type...</option>
                                    <option value="domestic">Domestic Installation</option>
                                    <option value="commercial">Commercial Installation</option>
                                    <option value="mixed">Mixed Use</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="capacityRequired">Cooling Capacity Required (kW) *</label>
                                <select id="capacityRequired" name="capacityRequired" required onchange="updatePreview()">
                                    <option value="">Select capacity...</option>
                                    <option value="2.5">2.5kW (Small room/office)</option>
                                    <option value="3.5">3.5kW (Medium room/office)</option>
                                    <option value="5.0">5.0kW (Large room/small office)</option>
                                    <option value="6.0">6.0kW (Large room/medium office)</option>
                                    <option value="7.1">7.1kW (Very large room/office)</option>
                                    <option value="9.0">9.0kW (Small commercial space)</option>
                                    <option value="10.0">10.0kW (Medium commercial space)</option>
                                    <option value="12.0">12.0kW (Large commercial space)</option>
                                    <option value="14.0">14.0kW (Very large commercial)</option>
                                    <option value="16.0">16.0kW (Industrial application)</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="indoorUnitType">Indoor Unit Type *</label>
                                <select id="indoorUnitType" name="indoorUnitType" required onchange="updatePreview()">
                                    <option value="">Select unit type...</option>
                                    <option value="wall">Wall Mounted Split</option>
                                    <option value="floor">Floor Standing</option>
                                    <option value="ceiling-cassette">Ceiling Cassette (4-way)</option>
                                    <option value="ceiling-ducted">Ceiling Ducted</option>
                                    <option value="multi-split">Multi-Split System</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="manufacturerPreference">Manufacturer Preference</label>
                                <select id="manufacturerPreference" name="manufacturerPreference" onchange="updatePreview()">
                                    <option value="any">Any Manufacturer (Best Value)</option>
                                    <option value="mitsubishi">Mitsubishi Electric Preferred</option>
                                    <option value="daikin">Daikin Preferred</option>
                                    <option value="fujitsu">Fujitsu Preferred</option>
                                    <option value="mhi">MHI Preferred</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="pipeRunDistance">Pipe Run Distance (meters) *</label>
                                <select id="pipeRunDistance" name="pipeRunDistance" required onchange="updatePreview()">
                                    <option value="">Select distance...</option>
                                    <option value="5">Up to 5m (Very short run)</option>
                                    <option value="10">5-10m (Short run)</option>
                                    <option value="15">10-15m (Medium run)</option>
                                    <option value="20">15-20m (Long run)</option>
                                    <option value="25">20-25m (Very long run)</option>
                                    <option value="30">25-30m (Extended run)</option>
                                    <option value="40">30-40m (Commercial long run)</option>
                                    <option value="50">40-50m (Maximum run)</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="installationDifficulty">Installation Complexity</label>
                                <select id="installationDifficulty" name="installationDifficulty">
                                    <option value="standard">Standard (Easy access, ground floor)</option>
                                    <option value="moderate">Moderate (Some height work, normal access)</option>
                                    <option value="difficult">Difficult (High access, tight spaces)</option>
                                    <option value="complex">Complex (Specialist access, multiple obstacles)</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Site Conditions -->
                    <div class="wizard-step" id="step3">
                        <div class="step-header">
                            <span class="step-number">3</span>
                            <h3>Site Conditions & Requirements</h3>
                        </div>
                        
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="drainageOption">Condensate Drainage</label>
                                <select id="drainageOption" name="drainageOption">
                                    <option value="gravity">Gravity drainage (downhill to outside)</option>
                                    <option value="pump-required">Condensate pump required</option>
                                    <option value="external-only">External drainage only</option>
                                    <option value="assessment-needed">Assessment required</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="accessEquipment">Access Equipment Required</label>
                                <select id="accessEquipment" name="accessEquipment">
                                    <option value="none">No special access required</option>
                                    <option value="ladders">Extension ladders sufficient</option>
                                    <option value="scaffold">Mobile scaffold required</option>
                                    <option value="cherry-picker">Cherry picker required</option>
                                    <option value="specialist">Specialist access required</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="coreHoles">Core Drilling Required</label>
                                <select id="coreHoles" name="coreHoles">
                                    <option value="none">No core drilling</option>
                                    <option value="small">1-2 small holes (110mm)</option>
                                    <option value="medium">2-3 medium holes (150mm)</option>
                                    <option value="large">Large holes or multiple (200mm+)</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="workingHours">Preferred Working Hours</label>
                                <select id="workingHours" name="workingHours">
                                    <option value="standard">Standard hours (8am-5pm)</option>
                                    <option value="early">Early start required</option>
                                    <option value="evening">Evening work required</option>
                                    <option value="weekend">Weekend work required</option>
                                    <option value="out-of-hours">Out of hours premium</option>
                                </select>
                            </div>
                            
                            <div class="form-group full-width">
                                <label>Documentation Required</label>
                                <div class="checkbox-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="documentation" value="method-statement">
                                        Method Statement
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="documentation" value="risk-assessment">
                                        Risk Assessment
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="documentation" value="permit-to-work">
                                        Permit to Work
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" name="documentation" value="hot-works">
                                        Hot Works Permit
                                    </label>
                                </div>
                            </div>
                            
                            <div class="form-group full-width">
                                <label for="additionalNotes">Additional Notes / Special Requirements</label>
                                <textarea id="additionalNotes" name="additionalNotes" rows="4" placeholder="Any specific requirements, constraints, or notes about the installation..."></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Navigation Buttons -->
                    <div class="wizard-navigation">
                        <button type="button" id="prevBtn" class="nav-btn secondary" style="display: none;" onclick="wizardPrev()">‚Üê Previous</button>
                        <button type="button" id="nextBtn" class="nav-btn primary" onclick="wizardNext()">Next ‚Üí</button>
                        <button type="button" id="generateQuote" class="nav-btn success" style="display: none;" onclick="generateQuote()">Generate Intelligent Quote ‚Üí</button>
                    </div>

                    <!-- Progress Indicator -->
                    <div class="progress-indicator">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill" style="width: 33%;"></div>
                        </div>
                        <div class="progress-steps">
                            <span class="progress-step active">Customer Info</span>
                            <span class="progress-step">Requirements</span>
                            <span class="progress-step">Site Conditions</span>
                        </div>
                    </div>
                </form>

                <!-- System Intelligence Preview -->
                <div class="intelligence-preview" id="intelligencePreview" style="display: none;">
                    <h3>üß† System Intelligence Preview</h3>
                    <div class="preview-content">
                        <div class="preview-section">
                            <h4>Recommended Equipment:</h4>
                            <p id="equipmentPreview">Select capacity and unit type to see recommendations...</p>
                        </div>
                        <div class="preview-section">
                            <h4>Pipe Sizing:</h4>
                            <p id="pipeSizingPreview">Select capacity to see pipe size recommendations...</p>
                        </div>
                        <div class="preview-section">
                            <h4>Estimated Cable Tray:</h4>
                            <p id="cableTrayPreview">Select pipe run distance for tray calculations...</p>
                        </div>
                        <div class="preview-section">
                            <h4>Pre-Selected Materials:</h4>
                            <p id="materialsPreview">Materials will be automatically calculated...</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <style>
        .company-logo-placeholder {
            width: 80px;
            height: 80px;
            background: var(--white);
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            color: var(--primary-green);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .form-group input.error,
        .form-group select.error {
            border-color: #FF3B30 !important;
            box-shadow: 0 0 0 3px rgba(255, 59, 48, 0.1) !important;
        }
    </style>

    <script>
        console.log('Oracle Wizard Loading...');
        
        var currentStep = 1;
        var totalSteps = 3;
        
        function wizardNext() {
            console.log('wizardNext called, step:', currentStep);
            
            if (validateStep()) {
                if (currentStep < totalSteps) {
                    // Hide current step
                    document.getElementById('step' + currentStep).classList.remove('active');
                    
                    // Show next step
                    currentStep++;
                    document.getElementById('step' + currentStep).classList.add('active');
                    
                    updateNavigation();
                    updateProgress();
                    
                    // Show preview on step 3
                    if (currentStep === 3) {
                        document.getElementById('intelligencePreview').style.display = 'block';
                        updatePreview();
                    }
                    
                    console.log('Advanced to step:', currentStep);
                }
            }
        }
        
        function wizardPrev() {
            console.log('wizardPrev called, step:', currentStep);
            
            if (currentStep > 1) {
                // Hide current step
                document.getElementById('step' + currentStep).classList.remove('active');
                
                // Show previous step
                currentStep--;
                document.getElementById('step' + currentStep).classList.add('active');
                
                updateNavigation();
                updateProgress();
                
                // Hide preview
                if (currentStep < 3) {
                    document.getElementById('intelligencePreview').style.display = 'none';
                }
                
                console.log('Back to step:', currentStep);
            }
        }
        
        function validateStep() {
            var stepElement = document.getElementById('step' + currentStep);
            var requiredFields = stepElement.querySelectorAll('[required]');
            var isValid = true;
            
            for (var i = 0; i < requiredFields.length; i++) {
                var field = requiredFields[i];
                if (!field.value.trim()) {
                    field.classList.add('error');
                    isValid = false;
                } else {
                    field.classList.remove('error');
                }
            }
            
            if (!isValid) {
                alert('Please fill in all required fields before continuing.');
            }
            
            return isValid;
        }
        
        function updateNavigation() {
            var prevBtn = document.getElementById('prevBtn');
            var nextBtn = document.getElementById('nextBtn');
            var generateBtn = document.getElementById('generateQuote');
            
            // Show/hide previous button
            prevBtn.style.display = currentStep > 1 ? 'block' : 'none';
            
            // Show/hide next vs generate button
            if (currentStep === totalSteps) {
                nextBtn.style.display = 'none';
                generateBtn.style.display = 'block';
            } else {
                nextBtn.style.display = 'block';
                generateBtn.style.display = 'none';
            }
        }
        
        function updateProgress() {
            var progressFill = document.getElementById('progressFill');
            var progressSteps = document.querySelectorAll('.progress-step');
            
            // Update progress bar
            var progressPercent = (currentStep / totalSteps) * 100;
            progressFill.style.width = progressPercent + '%';
            
            // Update step indicators
            for (var i = 0; i < progressSteps.length; i++) {
                if (i < currentStep) {
                    progressSteps[i].classList.add('active');
                } else {
                    progressSteps[i].classList.remove('active');
                }
            }
        }
        
        function updatePreview() {
            var capacity = document.getElementById('capacityRequired').value;
            var unitType = document.getElementById('indoorUnitType').value;
            var manufacturer = document.getElementById('manufacturerPreference').value;
            var distance = document.getElementById('pipeRunDistance').value;
            
            // Equipment recommendations
            if (capacity && unitType) {
                var equipmentText = 'Equipment for ' + capacity + 'kW ' + formatUnitType(unitType);
                if (manufacturer && manufacturer !== 'any') {
                    equipmentText += ' - ' + formatManufacturer(manufacturer) + ' preferred';
                }
                document.getElementById('equipmentPreview').textContent = equipmentText;
            }
            
            // Pipe sizing
            if (capacity) {
                var pipeText = getPipeSize(parseFloat(capacity));
                document.getElementById('pipeSizingPreview').textContent = pipeText;
            }
            
            // Cable tray
            if (distance) {
                var trayLengths = Math.ceil((parseInt(distance) + 5) / 3);
                document.getElementById('cableTrayPreview').textContent = 'Auto-calculated: ' + trayLengths + ' √ó 3m cable tray lengths';
            }
            
            // Materials
            if (capacity && distance) {
                document.getElementById('materialsPreview').textContent = 'Materials automatically calculated for ' + capacity + 'kW system with ' + distance + 'm pipe run';
            }
        }
        
        function formatUnitType(type) {
            switch(type) {
                case 'wall': return 'Wall Mounted';
                case 'ceiling-cassette': return 'Ceiling Cassette';
                case 'floor': return 'Floor Standing';
                case 'ceiling-ducted': return 'Ceiling Ducted';
                default: return type;
            }
        }
        
        function formatManufacturer(pref) {
            switch(pref) {
                case 'mitsubishi': return 'Mitsubishi Electric';
                case 'daikin': return 'Daikin';
                case 'fujitsu': return 'Fujitsu';
                case 'mhi': return 'MHI';
                default: return 'Any Manufacturer';
            }
        }
        
        function getPipeSize(capacity) {
            if (capacity <= 3.5) return 'Auto-selected: 1/4" √ó 3/8" pre-insulated set (Max: 20m)';
            if (capacity <= 5.0) return 'Auto-selected: 1/4" √ó 1/2" pre-insulated set (Max: 30m)';
            if (capacity <= 7.1) return 'Auto-selected: 3/8" √ó 5/8" pre-insulated set (Max: 40m)';
            if (capacity <= 10.0) return 'Auto-selected: 3/8" √ó 3/4" pre-insulated set (Max: 45m)';
            return 'Auto-selected: 1/2" √ó 7/8" pre-insulated set (Max: 50m)';
        }
        
        function generateQuote() {
            console.log('generateQuote called');
            
            if (validateStep()) {
                // Collect form data
                var form = document.getElementById('projectWizard');
                var formData = new FormData(form);
                var projectData = {};
                
                // Convert FormData to object
                for (var pair of formData.entries()) {
                    projectData[pair[0]] = pair[1];
                }
                
                console.log('Project data:', projectData);
                
                // Store in sessionStorage
                sessionStorage.setItem('oracleProjectData', JSON.stringify(projectData));
                
                var intelligenceData = {
                    capacity: parseFloat(projectData.capacityRequired),
                    unitType: projectData.indoorUnitType,
                    pipeDistance: parseInt(projectData.pipeRunDistance),
                    projectType: projectData.projectType,
                    manufacturerPref: projectData.manufacturerPreference,
                    complexity: projectData.installationDifficulty,
                    drainageOption: projectData.drainageOption,
                    accessEquipment: projectData.accessEquipment,
                    coreHoles: projectData.coreHoles
                };
                
                sessionStorage.setItem('oracleIntelligenceData', JSON.stringify(intelligenceData));
                
                console.log('Data stored, redirecting...');
                
                // Show loading state
                document.getElementById('generateQuote').textContent = 'Generating Intelligent Quote...';
                document.getElementById('generateQuote').disabled = true;
                
                // Redirect
                setTimeout(function() {
                    window.location.href = 'equipment.html';
                }, 1500);
            }
        }
        
        console.log('Oracle Wizard Ready');
    </script>
</body>
</html>
